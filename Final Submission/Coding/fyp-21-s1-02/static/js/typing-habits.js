var text;text="";var enteredText,timeTakenDwell,startDwellTime,stopDwellTime,recordDwellTime,timeTaken,startTime,stopTime,startFlightTime,stopFlightTime,test="";enteredText=[],window.onload=clearAll(),timetakenDwell=0,starDwelltTime=0,stopDwellTime=0,recordDwellTime=[],timeTake=0,startTime=0,stopTime=0,startFlightTime=[],stopFlightTime=[];var numOfTimeTyped,checkTimeTakenStarted,currentKey,checkFlight=!1;numOfTimeTyped=0,checkTimeTakenStarted=!1;var originalSentence,preventBkSpTime=!1,checkShift=!1,checkCaps=!1,checkArrow=!1;function timer(e){this.time=e}timer.prototype.getTime=function(){return this.time};var totalDwellTimeArray,totalAccuracyArray,totalWPMArray,totalTimeTakenArray,totalFlightTimeTakenArray,enteredTextArray,counter,resultsArray=[];function keyDown(e,t){if(0==checkTimeTakenStarted){var l=new timer(Date.now());startTime=l.getTime(),checkTimeTakenStarted=!0}if(8==t.charCode||8==t.keyCode)preventBkSpTime=!0;else if(16==t.keyCode)checkShift=!0;else if(20==t.keyCode)checkCaps=!0;else if(37==t.keyCode||38==t.keyCode||39==t.keyCode||40==t.keyCode)checkArrow=!0;else{l=new timer(Date.now());if(startDwellTime=l.getTime(),1==checkFlight)if(null!=document.getElementById(e).value&&0==document.getElementById(e).value.length)checkFlight=!1,stopFlightTime=[],startFlightTime=[];else{l=new timer(Date.now());stopFlightTime.push(l.getTime())}}}function keyPress(e){currentKey=e,enteredText.push(currentKey.key),numOfTimeTyped++}function keyUp(e,t){if(0==preventBkSpTime)if(1!=checkShift)if(1!=checkCaps)if(1!=checkArrow){var l=new timer(Date.now());if(stopDwellTime=l.getTime(),timeTakenDwell=stopDwellTime-startDwellTime,stopDwellTime=0,starDwelltTime=0,recordDwellTime.push(timeTakenDwell),timeTakenDwell=0,0==checkFlight){l=Date.now();startFlightTime.push(l),checkFlight=!0}else{l=Date.now();startFlightTime.push(l)}}else checkArrow=!1;else checkCaps=!1;else checkShift=!1;else{if(stopFlightTime.splice(-1),startFlightTime.splice(-1),startFlightTime.splice(-1),enteredText.splice(-1),recordDwellTime.splice(-1),0!=document.getElementById(t).value.length){l=Date.now();startFlightTime.push(l)}else checkFlight=!1;preventBkSpTime=!1}if(originalSentence=document.getElementById(t).value.length,text=document.getElementById(t).value,test=document.getElementById(e).innerHTML,text.length==test.length){l=new timer(Date.now());stopTime=l.getTime(),timeTaken=stopTime-startTime}}function clearAll(){startFlightTime=[],stopFlightTime=[],checkFlight=!1,timeTaken=0,totalDwellTime=0,numOfTimeTyped=0,totalFlightTime=0,text="",recordDwellTime=[],recordFlightTime=[],enteredText=[],totalDwellTimeArray=[],totalFlightTimeTakenArray=[],totalAccuracyArray=[],totalWPMArray=[]}function calculateResults(){if(0==test.localeCompare(text)){for(checkTimeTakenStarted=!1,i=0;i<recordDwellTime.length;i++)totalDwellTimeArray.push(recordDwellTime[i]);var e;for(e=test.length/numOfTimeTyped*100,totalAccuracyArray.push(e),i=0;i<stopFlightTime.length;i++){var t;t=stopFlightTime[i]-startFlightTime[i],totalFlightTimeTakenArray.push(t)}var l=parseFloat(enteredText.length/5),r=timeTaken/1e3;totalTimeTakenArray.push(r);var a=l/(timeTaken/6e4);return enteredTextArray.push(enteredText),totalWPMArray.push(a),!0}return!1}function packObject(e,t,l,r){return{accuracy:e,wpm:t,dwell:l,flight:r}}function loginConfirm(e,t,l){l.preventDefault();let r=JSON.stringify("");if(!1===calculateResults())alert("Sentence entered does not match generated sentence. Please try again.");else try{r=JSON.stringify(packObject(totalAccuracyArray[0],totalWPMArray[0],totalDwellTimeArray,totalFlightTimeTakenArray)),document.getElementById(t).value=r}catch(e){return!1}finally{document.getElementById(e).submit(),clearAll()}}totalDwellTimeArray=[],totalAccuracyArray=[],totalWPMArray=[],totalTimeTakenArray=[],totalFlightTimeTakenArray=[],enteredTextArray=[],counter=0;let habitCounter=1;function recalibrateAndRegister(e,t,l,r,i){i.preventDefault();let a=JSON.stringify(""),n=!1,c="";!1===(n=calculateResults())?alert("Sentence entered does not match generated sentence. Please try again."):(1==checkNaNValueInJSON(a=packObject(totalAccuracyArray[0],totalWPMArray[0],totalDwellTimeArray,totalFlightTimeTakenArray))?alert("Please type in the box below the generated sentence."):(resultsArray.push(a),10===habitCounter?(document.getElementById(l).style.display="none",document.getElementById(e).style.display="none",c="Press the button below to complete your habit validation.",document.getElementById(t).innerHTML=c,document.getElementById(r).style.display="block",habitCounter=1):habitCounter<10&&(c=String(habitCounter+1)+"/10 attempt(s)",document.getElementById(t).innerHTML=c,habitCounter++)),document.getElementById(e).value="",clearAll())}function submitRecalAndRegArray(e,t,l){l.preventDefault();let r=JSON.stringify(resultsArray);document.getElementById(e).value=r,document.getElementById(t).submit()}function checkNaNValueInJSON(e){for(key in e){if("object"==typeof e[key])return checkNaNValueInJSON(e[key]);if(isNaN(e[key]))return!0}return!1}